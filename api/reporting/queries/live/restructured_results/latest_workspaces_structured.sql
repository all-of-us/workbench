-- latest workspaces, broken into logical structs for easier comprehension.
SELECT
    STRUCT(w.workspace_id,
           w.name,
           w.creator_id,
           w.cdr_version_id,
           w.creation_time) AS metadata,
    STRUCT(w.creation_time,
           w.last_accessed_time,
           w.last_modified_time) AS history,
    STRUCT( w.rp_additional_notes AS additional_notes,
            w.rp_ancestry AS ancestry,
            w.rp_anticipated_findings AS anticipated_findings,
            w.rp_commercial_purpose AS commercial_purpose,
            w.rp_control_set AS control_set,
            w.rp_disease_focused_research AS disease_focused_research,
            w.rp_disease_of_focus AS disease_of_focus,
            w.disseminate_research_other,
            w.rp_drug_development AS drug_development,
            w.rp_educational AS educational,
            w.rp_ethics AS ethics,
            w.rp_intended_study AS intended_study,
            w.rp_methods_development AS methods_development,
            w.rp_other_population_details AS other_population_details,
            w.rp_other_purpose AS other_purpose,
            w.rp_other_purpose_details AS other_purpose_details,
            w.rp_population_health AS population_health,
            w.rp_reason_for_all_of_us AS reason_for_all_of_us,
            w.rp_scientific_approach AS scientific_approach,
            w.rp_social_behavioral AS social_behavioral,
            STRUCT(w.rp_review_requested AS rerquested,
                   w.rp_time_requested AS time_requested,
                   w.rp_approved AS approved,
                   w.needs_rp_review_prompt AS needs_user_prompt) AS review_rerquest ) AS research_purpose,
    STRUCT(w.billing_status AS status,
           w.billing_account_type AS account_type ) AS billing,
FROM
    `reporting_test.latest_workspaces` w;
